<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title></title>
	<link rel="stylesheet" href="normalize.css">
</head>
<body>
	<input type="file" onchange="readText(this);"/>
	<div id="chart"></div>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="d3.v4.min.js"></script>
	<script>
		var map = <%:maps%>;
		console.log(map);

		(function(d3) {
			var dataset = [
			{ label: 'Abulia', count: 10 },
			{ label: 'Betelgeuse', count: 20 },
			{ label: 'Cantaloupe', count: 30 },
			{ label: 'Dijkstra', count: 40 }
			];

			var width = 360;
			var height = 360;
			var radius = Math.min(width, height) / 2;

			var color = d3.scaleOrdinal(d3.schemeCategory20b);

			var svg = d3.select('#chart')
			.append('svg')
			.attr('width', width)
			.attr('height', height)
			.append('g')
			.attr('transform', 'translate(' + (width / 2) +
				',' + (height / 2) + ')');

			var arc = d3.arc()
			.innerRadius(0)
			.outerRadius(radius);

			var pie = d3.pie()
			.value(function(d) { return d.count; })
			.sort(null);

			var path = svg.selectAll('path')
			.data(pie(dataset))
			.enter()
			.append('path')
			.attr('d', arc)
			.attr('fill', function(d) {
				return color(d.data.label);
			});

		})(window.d3);

		function readText(filePath) {
			console.log(filePath.files[0]);
			var reader = new FileReader();
			if (filePath.files && filePath.files[0]) {           
				reader.onload = function (e) {
					var fileContents = e.target.result.trim();
					map = JSON.parse(fileContents);
					console.log(fileContents);
					console.log(map);
				}
            };
            reader.readAsText(filePath.files[0]);
        }
</script>
</body>
</html>
